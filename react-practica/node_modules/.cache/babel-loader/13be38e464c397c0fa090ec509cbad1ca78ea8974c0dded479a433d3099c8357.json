{"ast":null,"code":"import { createSlice, createAsyncThunk } from '@reduxjs/toolkit';\nimport { loginUser } from '../api/auth';\n\n// Async thunk to handle login\nexport const login = createAsyncThunk('auth/login', async ({\n  email,\n  password,\n  rememberMe\n}, {\n  rejectWithValue\n}) => {\n  try {\n    const response = await loginUser({\n      email,\n      password\n    });\n    const {\n      accessToken\n    } = response;\n    if (accessToken) {\n      if (rememberMe) {\n        localStorage.setItem('token', accessToken);\n      }\n      return accessToken;\n    }\n    return rejectWithValue(new Error('No access token received'));\n  } catch (error) {\n    var _error$response, _error$response$data;\n    return rejectWithValue(new Error(((_error$response = error.response) === null || _error$response === void 0 ? void 0 : (_error$response$data = _error$response.data) === null || _error$response$data === void 0 ? void 0 : _error$response$data.message) || 'Login failed'));\n  }\n});\n\n// Slice for user session\nconst userSlice = createSlice({\n  name: 'auth',\n  initialState: {\n    isAuthenticated: false,\n    user: null,\n    status: 'idle',\n    error: null\n  },\n  reducers: {\n    logout(state) {\n      state.isAuthenticated = false;\n      state.user = null;\n      localStorage.removeItem('token');\n    }\n  },\n  extraReducers: builder => {\n    builder.addCase(login.pending, state => {\n      state.status = 'loading';\n      state.error = null;\n    }).addCase(login.fulfilled, (state, action) => {\n      state.status = 'succeeded';\n      state.isAuthenticated = true;\n      state.user = {\n        token: action.payload\n      };\n    }).addCase(login.rejected, (state, action) => {\n      state.status = 'failed';\n      state.error = action.payload.message;\n    });\n  }\n});\nexport const {\n  logout\n} = userSlice.actions;\nexport default userSlice.reducer;","map":{"version":3,"names":["createSlice","createAsyncThunk","loginUser","login","email","password","rememberMe","rejectWithValue","response","accessToken","localStorage","setItem","Error","error","_error$response","_error$response$data","data","message","userSlice","name","initialState","isAuthenticated","user","status","reducers","logout","state","removeItem","extraReducers","builder","addCase","pending","fulfilled","action","token","payload","rejected","actions","reducer"],"sources":["C:/Users/huber/Documents/Source/Proyectos/KeepCoding/React_Avanzado/react-practica-main/react-practica/src/redux/userSlice.js"],"sourcesContent":["import { createSlice, createAsyncThunk } from '@reduxjs/toolkit';\nimport { loginUser } from '../api/auth';\n\n// Async thunk to handle login\nexport const login = createAsyncThunk(\n  'auth/login',\n  async ({ email, password, rememberMe }, { rejectWithValue }) => {\n    try {\n      const response = await loginUser({ email, password });\n      const { accessToken } = response;\n      if (accessToken) {\n        if (rememberMe) {\n          localStorage.setItem('token', accessToken);\n        }\n        return accessToken;\n      }\n      return rejectWithValue(new Error('No access token received'));\n    } catch (error) {\n      return rejectWithValue(new Error(error.response?.data?.message || 'Login failed'));\n    }\n  }\n);\n\n// Slice for user session\nconst userSlice = createSlice({\n  name: 'auth',\n  initialState: {\n    isAuthenticated: false,\n    user: null,\n    status: 'idle',\n    error: null,\n  },\n  reducers: {\n    logout(state) {\n      state.isAuthenticated = false;\n      state.user = null;\n      localStorage.removeItem('token');\n    },\n  },\n  extraReducers: (builder) => {\n    builder\n      .addCase(login.pending, (state) => {\n        state.status = 'loading';\n        state.error = null;\n      })\n      .addCase(login.fulfilled, (state, action) => {\n        state.status = 'succeeded';\n        state.isAuthenticated = true;\n        state.user = { token: action.payload };\n      })\n      .addCase(login.rejected, (state, action) => {\n        state.status = 'failed';\n        state.error = action.payload.message;\n      });\n  },\n});\n\nexport const { logout } = userSlice.actions;\nexport default userSlice.reducer;\n"],"mappings":"AAAA,SAASA,WAAW,EAAEC,gBAAgB,QAAQ,kBAAkB;AAChE,SAASC,SAAS,QAAQ,aAAa;;AAEvC;AACA,OAAO,MAAMC,KAAK,GAAGF,gBAAgB,CACnC,YAAY,EACZ,OAAO;EAAEG,KAAK;EAAEC,QAAQ;EAAEC;AAAW,CAAC,EAAE;EAAEC;AAAgB,CAAC,KAAK;EAC9D,IAAI;IACF,MAAMC,QAAQ,GAAG,MAAMN,SAAS,CAAC;MAAEE,KAAK;MAAEC;IAAS,CAAC,CAAC;IACrD,MAAM;MAAEI;IAAY,CAAC,GAAGD,QAAQ;IAChC,IAAIC,WAAW,EAAE;MACf,IAAIH,UAAU,EAAE;QACdI,YAAY,CAACC,OAAO,CAAC,OAAO,EAAEF,WAAW,CAAC;MAC5C;MACA,OAAOA,WAAW;IACpB;IACA,OAAOF,eAAe,CAAC,IAAIK,KAAK,CAAC,0BAA0B,CAAC,CAAC;EAC/D,CAAC,CAAC,OAAOC,KAAK,EAAE;IAAA,IAAAC,eAAA,EAAAC,oBAAA;IACd,OAAOR,eAAe,CAAC,IAAIK,KAAK,CAAC,EAAAE,eAAA,GAAAD,KAAK,CAACL,QAAQ,cAAAM,eAAA,wBAAAC,oBAAA,GAAdD,eAAA,CAAgBE,IAAI,cAAAD,oBAAA,uBAApBA,oBAAA,CAAsBE,OAAO,KAAI,cAAc,CAAC,CAAC;EACpF;AACF,CACF,CAAC;;AAED;AACA,MAAMC,SAAS,GAAGlB,WAAW,CAAC;EAC5BmB,IAAI,EAAE,MAAM;EACZC,YAAY,EAAE;IACZC,eAAe,EAAE,KAAK;IACtBC,IAAI,EAAE,IAAI;IACVC,MAAM,EAAE,MAAM;IACdV,KAAK,EAAE;EACT,CAAC;EACDW,QAAQ,EAAE;IACRC,MAAMA,CAACC,KAAK,EAAE;MACZA,KAAK,CAACL,eAAe,GAAG,KAAK;MAC7BK,KAAK,CAACJ,IAAI,GAAG,IAAI;MACjBZ,YAAY,CAACiB,UAAU,CAAC,OAAO,CAAC;IAClC;EACF,CAAC;EACDC,aAAa,EAAGC,OAAO,IAAK;IAC1BA,OAAO,CACJC,OAAO,CAAC3B,KAAK,CAAC4B,OAAO,EAAGL,KAAK,IAAK;MACjCA,KAAK,CAACH,MAAM,GAAG,SAAS;MACxBG,KAAK,CAACb,KAAK,GAAG,IAAI;IACpB,CAAC,CAAC,CACDiB,OAAO,CAAC3B,KAAK,CAAC6B,SAAS,EAAE,CAACN,KAAK,EAAEO,MAAM,KAAK;MAC3CP,KAAK,CAACH,MAAM,GAAG,WAAW;MAC1BG,KAAK,CAACL,eAAe,GAAG,IAAI;MAC5BK,KAAK,CAACJ,IAAI,GAAG;QAAEY,KAAK,EAAED,MAAM,CAACE;MAAQ,CAAC;IACxC,CAAC,CAAC,CACDL,OAAO,CAAC3B,KAAK,CAACiC,QAAQ,EAAE,CAACV,KAAK,EAAEO,MAAM,KAAK;MAC1CP,KAAK,CAACH,MAAM,GAAG,QAAQ;MACvBG,KAAK,CAACb,KAAK,GAAGoB,MAAM,CAACE,OAAO,CAAClB,OAAO;IACtC,CAAC,CAAC;EACN;AACF,CAAC,CAAC;AAEF,OAAO,MAAM;EAAEQ;AAAO,CAAC,GAAGP,SAAS,CAACmB,OAAO;AAC3C,eAAenB,SAAS,CAACoB,OAAO","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}